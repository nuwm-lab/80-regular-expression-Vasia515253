using System;
using System.Text.RegularExpressions;
using System.Collections.Generic;
using System.Linq;

namespace LabWork
{
    // ====================================================================
    // 1. –ö–ª–∞—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –Ω–æ–º–µ—Ä–Ω–∏–º–∏ –∑–Ω–∞–∫–∞–º–∏ (–Ü–Ω–∫–∞–ø—Å—É–ª—è—Ü—ñ—è)
    // ====================================================================
    /// <summary>
    /// –ö–ª–∞—Å –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑ –ø–æ—à—É–∫—É —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ.
    /// </summary>
    public static class LicensePlateFinder
    {
        // –†–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É –Ω–æ–º–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞–∫–∞: XXNNNNYY.
        // ^[A-Z]{2}   - –¥–≤—ñ –±—É–¥—å-—è–∫—ñ –ª–∞—Ç–∏–Ω—Å—å–∫—ñ –ª—ñ—Ç–µ—Ä–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É (–∫–æ–¥ –æ–±–ª–∞—Å—Ç—ñ)
        // [0-9]{4}   - —á–æ—Ç–∏—Ä–∏ —Ü–∏—Ñ—Ä–∏
        // [A-Z]{2}$  - –¥–≤—ñ –±—É–¥—å-—è–∫—ñ –ª–∞—Ç–∏–Ω—Å—å–∫—ñ –ª—ñ—Ç–µ—Ä–∏ –Ω–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ
        private const string PlatePattern = @"\b[A-Z]{2}[0-9]{4}[A-Z]{2}\b";
        
        // –ö–æ–¥–∏ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ (—Å—É—á–∞—Å–Ω–∏–π –†–ö —Ç–∞ —Å—Ç–∞—Ä–∏–π –í–ö)
        private static readonly HashSet<string> RivneCodes = new HashSet<string>
        {
            "–í–ö", "–†–ö"
        };

        /// <summary>
        /// –§—ñ–ª—å—Ç—Ä—É—î —Å–ø–∏—Å–æ–∫ –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∏—à–µ —Ç—ñ, —â–æ –Ω–∞–ª–µ–∂–∞—Ç—å –†—ñ–≤–Ω–µ–Ω—Å—å–∫—ñ–π –æ–±–ª–∞—Å—Ç—ñ.
        /// </summary>
        /// <param name="foundPlates">–°–ø–∏—Å–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Ñ–æ—Ä–º–∞—Ç—É.</param>
        /// <returns>–°–ø–∏—Å–æ–∫ –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ.</returns>
        private static List<string> FilterByRegion(IEnumerable<string> foundPlates)
        {
            List<string> rivnePlates = new List<string>();

            foreach (string plate in foundPlates)
            {
                // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–¥—É –æ–±–ª–∞—Å—Ç—ñ (–ø–µ—Ä—à—ñ –¥–≤—ñ –ª—ñ—Ç–µ—Ä–∏)
                string regionCode = plate.Substring(0, 2); 
                
                if (RivneCodes.Contains(regionCode))
                {
                    rivnePlates.Add(plate);
                }
            }

            return rivnePlates;
        }

        /// <summary>
        /// –ó–Ω–∞—Ö–æ–¥–∏—Ç—å —É—Å—ñ –Ω–æ–º–µ—Ä–Ω—ñ –∑–Ω–∞–∫–∏ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ —É –∑–∞–¥–∞–Ω–æ–º—É —Ç–µ–∫—Å—Ç—ñ.
        /// </summary>
        /// <param name="text">–í—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ—à—É–∫—É.</param>
        /// <returns>–°–ø–∏—Å–æ–∫ –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ.</returns>
        public static List<string> FindRivnePlates(string text)
        {
            if (string.IsNullOrEmpty(text))
            {
                return new List<string>();
            }

            // 1. –ü–æ—à—É–∫ —É—Å—ñ—Ö –∑–±—ñ–≥—ñ–≤ –∑–∞ —Ñ–æ—Ä–º–∞—Ç–æ–º (XX0000YY)
            // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ ToUpperInvariant –¥–ª—è —É–Ω—ñ—Ñ—ñ–∫–∞—Ü—ñ—ó —Ä–µ–≥—ñ—Å—Ç—Ä—É, —Ö–æ—á–∞ RegEx –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —á—É—Ç–ª–∏–≤–∏–π –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É
            // —ñ –º–∏ —à—É–∫–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ [A-Z].
            MatchCollection matches = Regex.Matches(text.ToUpperInvariant(), PlatePattern);

            // 2. –í–∏–¥—ñ–ª–µ–Ω–Ω—è –∑–Ω–∞–π–¥–µ–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤ —É —Å–ø–∏—Å–æ–∫
            var allFoundPlates = matches.Cast<Match>()
                                        .Select(m => m.Value)
                                        .ToList();

            // 3. –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –∫–æ–¥–æ–º –æ–±–ª–∞—Å—Ç—ñ
            return FilterByRegion(allFoundPlates);
        }
    }

    // ====================================================================
    // 2. –ì–æ–ª–æ–≤–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞
    // ====================================================================
    class Program
    {
        static void Main(string[] args)
        {
            Console.OutputEncoding = System.Text.Encoding.UTF8;
            Console.WriteLine("## üîé –ü–æ—à—É–∫ –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ –∑–∞ RegEx\n");

            // –ó–∞–¥–∞–Ω–∏–π —Ç–µ–∫—Å—Ç, —â–æ –º—ñ—Å—Ç–∏—Ç—å –Ω–æ–º–µ—Ä–∏ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤ —Ç–∞ –æ–±–ª–∞—Å—Ç–µ–π
            string inputText = @"
                –ó—É—Å—Ç—Ä—ñ—á–∞–ª–∏—Å—è —Ç–∞–∫—ñ –º–∞—à–∏–Ω–∏: –í–ö0001–ê–û (–†—ñ–≤–Ω–µ), –ê–ê9999–ö–ú (–ö–∏—ó–≤),
                –†–ö1234–í–° (–†—ñ–≤–Ω–µ, –Ω–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç), –°–ú1111–ê–í (–°—É–º–∏),
                VK7777XY (–†—ñ–≤–Ω–µ, —ñ–Ω—à–∏–π —Ä–µ–≥—ñ—Å—Ç—Ä),
                –ù–æ–º–µ—Ä –∑ –ø–æ–º–∏–ª–∫–æ—é 12345678,
                –Ü–Ω–æ–º–∞—Ä–∫–∞ –∑ –Ω–æ–º–µ—Ä–æ–º –ê–†0000–ö–ù (–ê–† - –ö—Ä–∏–º/–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å/–ö—Ä–∏–≤–∏–π –†—ñ–≥, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ñ–æ—Ä–º–∞—Ç—É).
                –©–µ –æ–¥–∏–Ω –†—ñ–≤–Ω–µ–Ω—Å—å–∫–∏–π –Ω–æ–º–µ—Ä: –í–ö5555–í–ö.
                –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç: –†–ö123–ê–í.
            ";

            Console.WriteLine("--- –í—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç ---");
            Console.WriteLine(inputText.Trim());
            Console.WriteLine(new string('-', 35));

            // –í–∏–∫–ª–∏–∫ –º–µ—Ç–æ–¥—É –¥–ª—è –ø–æ—à—É–∫—É
            List<string> rivnePlates = LicensePlateFinder.FindRivnePlates(inputText);

            // –í–∏–≤–µ–¥–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
            if (rivnePlates.Count > 0)
            {
                Console.WriteLine($"\n‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ {rivnePlates.Count} –Ω–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ (–í–ö, –†–ö):");
                foreach (string plate in rivnePlates)
                {
                    Console.WriteLine($"\t- {plate}");
                }
            }
            else
            {
                Console.WriteLine("\n‚ùå –ù–æ–º–µ—Ä–Ω–∏—Ö –∑–Ω–∞–∫—ñ–≤ –†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.");
            }
            
            Console.WriteLine(new string('-', 35));
            Console.WriteLine("–ü—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞ —Ä–æ–±–æ—Ç—É.");
            // Console.ReadKey(); 
        }
    }
}
